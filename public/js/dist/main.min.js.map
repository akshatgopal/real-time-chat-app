{"version":3,"sources":["main.js"],"names":["chatForm","document","getElementById","chatMessages","querySelector","Qs","parse","location","search","ignoreQueryPrefix","username","room","io","outputMessage","createElement","div","classList","p","innerText","add","message","innerHTML","time","para","appendChild","text","roomName","userList","users","forEach","li","socket","_ref","outputUsers","outputRoomName","scrollTop","scrollHeight","e","preventDefault","elements","msg","value","emit","target","focus","leaveRoom","confirm","addEventListener","window"],"mappings":"aAAA,IAAMA,SAAWC,SAASC,eAAe,aACnCC,aAAeF,SAASG,cAAc,kBADtCJ,SAAWC,SAASC,eAAe,aACnCC,SAAYF,SAAGA,eAAA,mBAKMI,GAAGC,MAAMC,SAASC,OAAQ,CACnDC,mBAD4BH,IAAtBI,mBAAAA,SAAUC,eAAAA,KAAVD,OAIOE,KA2Cb,SAASC,cAAYC,GACrBC,IAAIC,EAAAA,SAAcF,cAAlB,OACAC,EAAME,UAAIhB,IAASa,WACnBG,IAAED,EAAAA,SAAcF,cAAhB,KACAG,EAAEC,UAAFC,IAAcC,QACdH,EAAEI,UAAFD,EAAAV,SACAK,EAAAA,WAAAA,SAAAA,OAAAK,EAAAE,KAAAP,WACAA,EAAMQ,YAAOtB,GACbsB,IAAKP,EAAAA,SAAcF,cAAnB,KACAS,EAAKL,UAALC,IAAiBC,QACjBL,EAAIS,UAAYD,EAAhBE,KACAxB,EAAAA,YAASG,GAGXH,SAAAG,cAAA,kBAAAoB,YAAAT,GAEEW,SAAAA,eAAqBf,GAGvBe,SAAAR,UAAAP,EAEEgB,SAAAA,YAAAC,GACAA,SAAMC,UAAQ,GACZD,EAAME,QAAK7B,SAAAA,GACX6B,IAAGZ,EAAAA,SAAiBR,cAApB,MACAiB,EAAAA,UAASH,EAATd,SAHFiB,SAAAH,YAAAM,KAjEFC,OAAMA,KAAM,WAEZ,CAAArB,SAAAA,SAAAC,KAAAA,OAC0BD,OAAAA,GAAQ,YAAV,SAAAsB,GAAA,IAAArB,EAAAqB,EAAArB,KAAAiB,EAAAI,EAAAJ,MAAYjB,eAAAA,GAApCsB,YAEAL,KAC4CG,OAAZH,GAAAA,UAAAA,SAAAA,GAC9BM,QAAAA,IAAAA,GACAD,cAAYL,GAIdG,aAAUI,UAAWhC,aAAaiC,eAKhCjC,SAAAA,iBAAA,SAAyBA,SAAAA,GAL3BkC,EAQAC,iBAEED,IAAEC,EAAAA,EAAAA,OADuCC,SAGzCC,IAAAC,MAKA,KAJAD,EAAIA,EAAMH,QAIV,OAAA,EAKAN,OAAOW,KAAK,cAAeF,GAG3BH,EAAEM,OAAOJ,SAASC,IAAIC,MAAQ,GAC9BJ,EAAEM,OAAOJ,SAASC,IAAII,UAoCtB3C,SAAM4C,eAAYC,aAAQC,iBAAA,QAA1B,WAAkBD,QAAQ,iCAExBE,OAAOzC,SAAW","file":"main.min.js","sourcesContent":["const chatForm = document.getElementById('chat-form');\r\nconst chatMessages = document.querySelector('.chat-messages');\r\nconst roomName = document.getElementById('room-name');\r\nconst userList = document.getElementById('users');\r\n\r\n// Get username and room from URL\r\nconst { username, room } = Qs.parse(location.search, {\r\n  ignoreQueryPrefix: true,\r\n});\r\n\r\nconst socket = io();\r\n\r\n// Join chatroom\r\nsocket.emit('joinRoom', { username, room });\r\n\r\n// Get room and users\r\nsocket.on('roomUsers', ({ room, users }) => {\r\n  outputRoomName(room);\r\n  outputUsers(users);\r\n});\r\n\r\n// Message from server\r\nsocket.on('message', (message) => {\r\n  console.log(message);\r\n  outputMessage(message);\r\n\r\n  // Scroll down\r\n  chatMessages.scrollTop = chatMessages.scrollHeight;\r\n});\r\n\r\n// Message submit\r\nchatForm.addEventListener('submit', (e) => {\r\n  e.preventDefault();\r\n\r\n  // Get message text\r\n  let msg = e.target.elements.msg.value;\r\n\r\n  msg = msg.trim();\r\n\r\n  if (!msg) {\r\n    return false;\r\n  }\r\n\r\n  // Emit message to server\r\n  socket.emit('chatMessage', msg);\r\n\r\n  // Clear input\r\n  e.target.elements.msg.value = '';\r\n  e.target.elements.msg.focus();\r\n});\r\n\r\n// Output message to DOM\r\nfunction outputMessage(message) {\r\n  const div = document.createElement('div');\r\n  div.classList.add('message');\r\n  const p = document.createElement('p');\r\n  p.classList.add('meta');\r\n  p.innerText = message.username;\r\n  p.innerHTML += `<span>${message.time}</span>`;\r\n  div.appendChild(p);\r\n  const para = document.createElement('p');\r\n  para.classList.add('text');\r\n  para.innerText = message.text;\r\n  div.appendChild(para);\r\n  document.querySelector('.chat-messages').appendChild(div);\r\n}\r\n\r\n// Add room name to DOM\r\nfunction outputRoomName(room) {\r\n  roomName.innerText = room;\r\n}\r\n\r\n// Add users to DOM\r\nfunction outputUsers(users) {\r\n  userList.innerHTML = '';\r\n  users.forEach((user) => {\r\n    const li = document.createElement('li');\r\n    li.innerText = user.username;\r\n    userList.appendChild(li);\r\n  });\r\n}\r\n\r\n//Prompt the user before leave chat room\r\ndocument.getElementById('leave-btn').addEventListener('click', () => {\r\n  const leaveRoom = confirm('Want to leave the chatroom?');\r\n  if (leaveRoom) {\r\n    window.location = '../index.html';\r\n  } else {\r\n  }\r\n});"]}