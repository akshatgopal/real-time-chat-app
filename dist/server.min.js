"use strict";var path=require("path"),http=require("http"),express=require("express"),socketio=require("socket.io"),formatMessage=require("./utils/messages"),_require=require("./utils/users"),userJoin=_require.userJoin,getCurrentUser=_require.getCurrentUser,userLeave=_require.userLeave,getRoomUsers=_require.getRoomUsers,app=express(),server=http.createServer(app),io=socketio(server);app.use(express.static(path.join(__dirname,"public")));var botName="Realtime Bot";io.on("connection",function(t){t.on("joinRoom",function(e){var r=e.username,o=e.room,s=userJoin(t.id,r,o);t.join(s.room),t.emit("message",formatMessage(botName,"Welcome to Realtime chat app!")),t.broadcast.to(s.room).emit("message",formatMessage(botName,"".concat(s.username," has joined the chat"))),io.to(s.room).emit("roomUsers",{room:s.room,users:getRoomUsers(s.room)})}),t.on("chatMessage",function(e){var r=getCurrentUser(t.id);io.to(r.room).emit("message",formatMessage(r.username,e))}),t.on("disconnect",function(){var e=userLeave(t.id);e&&(io.to(e.room).emit("message",formatMessage(botName,"".concat(e.username," has left the chat"))),io.to(e.room).emit("roomUsers",{room:e.room,users:getRoomUsers(e.room)}))})});var PORT=process.env.PORT||4e3;server.listen(PORT,function(){return console.log("Server running on port ".concat(PORT))});
//# sourceMappingURL=server.min.js.map
